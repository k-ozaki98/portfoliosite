---
import Layout from '../layouts/Layout.astro';
import { getBlogs } from '../lib/microcms';

try {
    const response = await getBlogs({ limit: 6 });
    console.log('API Response:', JSON.stringify(response, null, 2));
    const { contents: blogs } = response;
    
    // 個別のブログデータをチェック
    blogs.forEach((blog, index) => {
        console.log(`Blog ${index + 1}:`, {
            title: blog.title,
            category: blog.category,
            date: blog.publishedAt
        });
    });

} catch (error) {
    console.error('Error fetching blogs:', error);
}

// 通常の取得
const { contents: blogs } = await getBlogs({ limit: 6 });
---

<Layout pageId='top' title='my portfolio' description='尾崎幸喜のポートフォリオサイトです'>
  <!-- MV Section -->
  <section id="mv" class="mv section">
      <div class="mv__content l-inner">
          
          <div id="lottie-animation" class="mv__animation">
          </div>
          <div class="mv__wrap">
            <h1>「作ってよかった」を実感する<br>ホームページ</h1>
            <p class="mv__text">フロントエンド開発で、<br>あなたのブランドを最大限に引き立てます</p>

          </div>

      </div>
  </section>

  <!-- About Section -->
  <section id="about" class="about section">
      <div class="l-inner">
          <h2 class="section__title">About</h2>
          <div class="about__content">
              <div class="about__text">
                  <p>大阪府大阪市を拠点にホームぺージ制作をしている<br>フロントエンドエンジニアです。</p>
                  <br>
                  <p>ホームぺージは完成してから育てていく必要があります。<br>
                    お客様の想い・情報をホームページで形にした後、<br>
                    更新作業や改善サポートを行いますので、一貫してお任せいただくことができます。</p>
                    <br>
                  <p>主な技術スタック：
                  React, Next.js, Astro, TypeScript</p>
              </div>
              <div class="about__img profile-image">
                <img src="../assets/images/top/profile.jpg" alt="">
              </div>
          </div>
      </div>
  </section>

  <!-- Services Section -->
  <section id="service" class="service section">
      <div class="l-inner">
          <h2 class="section__title">Service</h2>
          <div class="service__grid">
              <div class="service__card">
                  <h3>Webサイト制作</h3>
                  <p>しっかりヒアリングを行い、魅力的なwebサイト制作をいたします。</p>
              </div>
              <div class="service__card">
                  <h3>Webサイト修正</h3>
                  <p>Webサイトの改善や新規ページを増やしたいなどの対応をいたします。</p>
              </div>
              <div class="service__card">
                  <h3>その他・ご相談</h3>
                  <p>Webサイト制作での不安やデザインに関するご相談を受け付けています。</p>
              </div>
          </div>
      </div>
  </section>

  <!-- Blog Section -->
<section id="blog" class="blog section">
  <div class="l-inner">
      <h2 class="section__title">Blog</h2>
      <div class="blog__grid">
          {blogs.map((blog) => (
              <article class="blog__card">
                  <a href={`/blog/${blog.id}`} class="blog__link">
                      <div class="blog__thumbnail">
                          {blog.thumbnail ? (
                              <img 
                                  src={`${blog.thumbnail.url}?w=800`}
                                  alt={blog.title}
                                  width={400}
                                  height={225}
                              />
                          ) : (
                              <div class="blog__thumbnail-placeholder">
                                  No Image
                              </div>
                          )}
                      </div>
                      <div class="blog__content">
                          <div class="blog__header">
                            <div class="blog__footer">
                                <time datetime={blog.publishedAt} class="blog__date">
                                    {new Date(blog.publishedAt).toLocaleDateString('ja-JP', {
                                        year: 'numeric',
                                        month: 'short',
                                        day: 'numeric'
                                    })}
                                </time>
                            </div>
                            {blog.categories && blog.categories.length > 0 && (
                                <div class="blog__categories">
                                    {blog.categories.map((category) => (
                                        <span class="blog__category">
                                            {category.name}
                                        </span>
                                    ))}
                                </div>
                            )}
                            

                          </div>
                          <h3 class="blog__title">{blog.title}</h3>
                      </div>
                  </a>
              </article>
          ))}
      </div>
      <div class="blog__more">
          <a href="/blog" class="btn-A">
              <span class="text">View All</span>
          </a>
      </div>
  </div>
</section>


  <!-- Works Section -->
  <section id="work" class="work section">
    <div class="l-inner">
        <h2 class="section__title">Works</h2>
        <div class="work__grid">
            <div class="work__card">
                <a href="https://smile104.net/" target="_blank" class="work__link">
                    <div class="work__thumbnail">
                        <img src="../assets/images/top/work01.png" alt="企業サイト制作" />
                    </div>
                    <div class="work__content">
                      <p class="work__description">Webサイト制作</p>
                      <div class="work__tags">
                          <span class="work__tag">Astro</span>
                          <span class="work__tag">JavaScript</span>
                          <span class="work__tag">SCSS</span>
                      </div>
                        <h3 class="work__title">癒しサロンSmile様 コーポレートサイト</h3>
                    </div>
                </a>
            </div>
            <div class="work__card">
                <a href="https://ozakikoki.com/" target="_blank" class="work__link">
                    <div class="work__thumbnail">
                        <img src="../assets/images/top/work02.png" alt="LPサイト制作" />
                    </div>
                    <div class="work__content">
                      <p class="work__description">キャンペーンサイト新規制作</p>
                      <div class="work__tags">
                          <span class="work__tag">Next.js</span>
                          <span class="work__tag">TypeScript</span>
                          <span class="work__tag">Tailwind CSS</span>
                      </div>
                        <h3 class="work__title">アニメーション重視のポートフォリオサイト</h3>
                    </div>
                </a>
            </div>
        </div>

        <div class="work__more">
          <a href="/blog" class="btn-A">
              <span class="text">View All</span>
          </a>
      </div>
    </div>
</section>

</Layout>

   

<style lang="scss">
  @import '../styles/vars.scss';
:root {
  --color-primary: #8749ff;     // メインの深い緑
  --color-primary-light: #a77cff;  // 明るい緑
  --color-primary-dark: #a77cff;   // 暗い緑
  --color-accent: #c6aaff;      // アクセントの薄緑
  --color-text: #333333;        // 文字色
  --color-text-light: #666666;  // 薄い文字色
  --color-background: #FFFFFF;  // 背景色
  --color-gray: #F5F5F5;       // グレー背景
}

  /* MV Section */
  .mv {
      display: flex;
      align-items: center;
      justify-content: center;
      // background: linear-gradient(45deg, var(--color-primary), var(--color-primary-light));
      color: white;
      text-align: center;
      padding: 10rem 0;
      height: 50vh;

      &__content {
        display: flex;
        align-items: center;
        position: relative;
      }
      h1 {
          font-size: 2.8rem;
          margin-bottom: 1rem;
      }
      &__text {
          font-size: 1.5rem;
      }

      &__animation {
        width: 70%;
        left: -6rem;
        position: relative;
      }

      &__wrap {
        width: 50%;
        margin-left: auto;
        background: linear-gradient(45deg, var(--color-primary), var(--color-primary-light));
        position: absolute;
        top: 50%;
        transform: translateY(0%);
        right: -5rem;
        z-index: 2;
        padding: 3rem 2rem;
        border-radius: 30px;
      }
  }



  /* Common Section Styles */
  .section {
      padding: 8rem 2rem;
      &__title {
          color: var(--color-primary);
          font-size: 4rem;
          text-align: center;
          margin-bottom: 3rem;
          font-weight: normal;
          &::after {
            content: '';
            display: block;
            width: 6rem;
            height: 3px;
            background: var(--color-accent);
            margin: 1rem auto 0;
        }

      }
  }


  .container {
      max-width: 1200px;
      margin: 0 auto;
  }

  /* About Section */
  .about {
      background: #fff;
      &__content {
        display: flex;
          gap: 2rem;
          align-items: center;
      }
    
      &__text {
          line-height: 1.8;
          width: 70%;
      }
  }


  .profile-image {
      width: 23rem;
      height: 23rem;
      border-radius: 50%;
      background: #eee;
      margin: 0 auto;
      overflow: hidden;
      box-shadow: 5px 5px 15px -5px #777777;

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
  }

  /* Services Section */
  .service {
      background: #f3f3fe;
      &__grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
      }
    
      &__card {
          padding: 2rem 3rem;
          border-right: 1px solid rgba(46, 125, 50, 0.1);
          transition: all 0.3s ease;

          &:last-of-type {
            border: none;
          }
          h3 {
              font-size: 2rem;
              color: var(--color-primary);
              text-align: center;
              margin-bottom: 2rem;
              padding-bottom: 2rem;
              position: relative;

              &::after {
                content: "";
                width: 5rem;
                height: 2px;
                background: var(--color-accent);
                position: absolute;
                bottom: 0;
                left: 50%;
                transform: translateX(-50%);

              }
          }
      }
    
  }


  /* Blog Section */
  .blog {
    background: #fff;
    
    &__grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 4rem;
        margin-bottom: 5rem;
    }
    
    &__card {
        background: #fff;
        transition: all 0.3s ease;
        
        &:hover {
            .blog__thumbnail img {
                transform: scale(1.03);
            }
        }
    }
    
    &__link {
        text-decoration: none;
        color: inherit;
        display: block;
    }
    
    &__thumbnail {
        position: relative;
        overflow: hidden;
        background: #f8f8f8;
        aspect-ratio: 16/9;
        
        img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
    }
    
    &__content {
        padding: 1.5rem 0;
    }
    
    &__categories {
        display: flex;
        gap: 0.5rem;
    }
    
    &__category {
        font-size: 1.3rem;
        letter-spacing: 0.05em;
        color: #666;
        border: 1px solid #999;
        padding: 0 0.75rem;
        color: #999;
    }

    &__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }
    
    &__title {
        font-size: 1.6rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        line-height: 1.4;
    }
    
    &__excerpt {
        font-size: 1rem;
        line-height: 1.6;
        color: #666;
        margin-bottom: 1rem;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    
    &__date {
        font-size: 1rem;
        color: #999;
        letter-spacing: 0.05em;
    }
}

.more-link {
    display: inline-block;
    background: var(--color-primary);
    border: 1px solid #111;
    color: #111;
    padding: 1rem 3rem;
    font-size: 0.875rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    text-decoration: none;
    transition: all 0.3s ease;
    
    &:hover {
      background: var(--color-primary-dark);
        color: #fff;
    }
}



  /* Works Section */
  .work {
    background: #f3f3fe;

    &__grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 4rem;
        margin-bottom: 4rem;
    }
    
    &__card {
        overflow: hidden;
        transition: all 0.3s ease;
        
        &:hover {
            
            .work__thumbnail img {
                transform: scale(1.03);
            }

            .work__title {
              color: var(--color-primary);
            }
        }
    }

    &__link {
        text-decoration: none;
        color: inherit;
        display: block;
    }
    
    &__thumbnail {
        position: relative;
        overflow: hidden;
        aspect-ratio: 16/9;
        
        img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
    }
    
    &__content {
        padding: 2rem;
    }
    
    &__title {
        font-size: 1.8rem;
        font-weight: 600;
        line-height: 1.4;
        transition: 0.3s;
        
    }
    
    &__description {
        font-size: 1.4rem;
        color: #666;
        margin-bottom: 1.5rem;
    }
    
    &__tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-bottom: 1rem;
    }
    
    &__tag {
        font-size: 1.3rem;
        letter-spacing: 0.05em;
        color: #666;
        border: 1px solid #999;
        padding: 0 0.75rem;
        color: #999;
    }
}


  

  /* Responsive Design */
  @media (max-width: 768px) {
      .about-content {
          grid-template-columns: 1fr;
      }

      .services-grid {
          grid-template-columns: 1fr;
      }

      .blog-grid {
          grid-template-columns: 1fr;
      }

      .works-grid {
          grid-template-columns: 1fr;
      }

      #mv h1 {
          font-size: 2.5rem;
      }

      .section-title {
          font-size: 2rem;
      }
  }
</style>

<script>
  import gsap from 'gsap';

  document.addEventListener('DOMContentLoaded', function () {
    var animation = lottie.loadAnimation({
      container: document.getElementById('lottie-animation'),
      renderer: 'svg',
      loop: true,
      autoplay: true,
      path: '../assets/animations/mv-animation.json'
    });

    gsap.fromTo('.mv__wrap', 
      {
        opacity: 0,
        y: 30
      },
      {
        opacity: 1,
        y: 0,
        duration: 1,
        delay: 0.5, // Lottieアニメーションの後に表示
        ease: 'power2.out'
      }
    );
  });
</script>
